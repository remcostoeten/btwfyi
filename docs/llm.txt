# btwfyi - LLM Integration Guide

> A lightweight task awareness overlay for development environments.
> Latin "vigilo" — to watch, stay alert, keep aware.

## Overview

btwfyi is a React/Vue overlay component that displays development tasks and can draw visual connector lines from tasks to DOM elements. It supports localStorage or database persistence.

---

## 1. Installation

```bash
pnpm add @remcostoeten/btwfyi
# or
npm install @remcostoeten/btwfyi
# or
bun add @remcostoeten/btwfyi
```

---

## 2. Basic Setup - Render btwfyi in React

```tsx
import { Btwfyi } from '@remcostoeten/btwfyi/react'
import type { CategoryConfig } from '@remcostoeten/btwfyi'

const categories: CategoryConfig[] = [
  {
    id: 'development',
    displayName: 'Dev Tasks',
    items: [
      { text: 'Fix auth bug', action: 'fix', priority: 'high' },
      { text: 'Add profile page', action: 'feat', priority: 'medium' },
    ],
  },
]

export default function App() {
  return (
    <Btwfyi
      category="development"
      categories={categories}
      enabled={process.env.NODE_ENV === 'development'}
    />
  )
}
```

---

## 3. Smart Syntax (Natural Language Task Entry)

Parse dates, tags, and priorities from natural language:

```typescript
import { parseSmartSyntax } from '@remcostoeten/btwfyi'

const result = parseSmartSyntax("Fix bug tomorrow #auth !high")
// { text: "Fix bug", dueDate: Date, tags: ["auth"], priority: "high" }
```

### Supported Syntax
- **Dates**: "tomorrow", "next friday", "dec 31", "in 3 days"
- **Tags**: `#tagname` (e.g., `#bug`, `#feature`)
- **Priority**: `!high`, `!medium`, `!low`, `!urgent`, `!1`, `!2`, `!3`

---

## 4. AI Integration

### Local AI (Chrome's window.ai)
Works offline using Gemini Nano. Available if `window.ai` is present.

### Cloud AI (Grok)
Pass your API key for smarter parsing:

```tsx
<Btwfyi
  category="dev"
  categories={categories}
  aiConfig={{ grokApiKey: process.env.GROK_KEY }}
/>
```

### AI Functions
```typescript
import { smartParseWithGrok, enhanceWithGrok } from '@remcostoeten/btwfyi/react'

// Extract tasks from unstructured text
const tasks = await smartParseWithGrok("Fix the auth bug. Also call mom.", apiKey)
// [{ text: "Fix the auth bug", ... }, { text: "Call mom", ... }]

// Enhance task text
const enhanced = await enhanceWithGrok("buy milk urgent", apiKey)
// "Buy milk !high #shopping"
```

---

## 5. Import/Export

### Export Tasks
```typescript
// In Command Palette Management View (type "btwfyi")
// Click "Copy MD" → Markdown list
// Click "Copy Slack" → Slack-formatted list
// Click "JSON" → Raw JSON array
```

### Import Tasks
Paste into Command Palette:
- **JSON Array**: `[{"text": "Task 1"}, {"text": "Task 2"}]`
- **Markdown List**: `- Task 1\n- Task 2`

---

## 6. CategoryConfig Structure

```typescript
type TodoItem = {
  text: string              // Main task text (required)
  action?: string           // Short label: 'fix', 'feat', 'perf'
  info?: string             // Short info text
  description?: string      // Longer description
  notes?: string            // Additional notes
  dueDate?: Date | string   // Due date
  priority?: 'low' | 'medium' | 'high'
  tags?: string[]           // Tags for filtering
  createdAt?: string        // ISO 8601 timestamp
  updatedAt?: string        // ISO 8601 timestamp
}

type CategoryConfig = {
  id: string                // Unique category identifier
  displayName?: string      // Human-readable name
  items: TodoItem[]         // Array of tasks
}
```

---

## 7. Add Connectors Programmatically

```typescript
import { useBtwfyiInstance } from '@remcostoeten/btwfyi/react'

const { addConnection, setConnections } = useBtwfyiInstance({
  instanceId: 'development',
})

// Connect to CSS selector
addConnection(0, '#my-button')
addConnection(1, '.sidebar-nav', 'Navigation')

// Connect to fixed position
addConnection(3, { x: 500, y: 300 })

// Set all connections at once
setConnections([
  { todoIndex: 0, targetSelector: '#header', targetLabel: 'Header' },
  { todoIndex: 1, targetPosition: { x: 800, y: 400 } },
])
```

---

## 8. Command Palette

| Command | Action |
|---------|--------|
| `Alt + K` | Open palette |
| Type `btwfyi` | Management view |
| `Escape` | Close palette |
| Type + Enter | Create task via Smart Syntax |
| Paste list | Bulk import tasks |

---

## 9. Props Reference

```typescript
interface BtwfyiProps {
  category: string                    // Category ID (required)
  categories: CategoryConfig[]        // All categories (required)
  instanceId?: string                 // Unique instance ID
  enabled?: boolean                   // Enable/disable (default: true)
  onTaskCreate?: (task) => void       // Task creation callback
  aiConfig?: {
    grokApiKey?: string               // Grok API key
    preferCloud?: boolean             // Prefer cloud over local AI
  }
  themeOverrides?: ThemeOverrides     // Theme customization
  stylesOverrides?: Partial<Styles>   // Style customization
  colorMode?: 'light' | 'dark'        // Color mode
}
```

---

## 10. Keyboard Shortcuts

| Key | Action |
|-----|--------|
| `s` | Open settings |
| `?` | Show keyboard help |
| `/` | Focus search |
| `l` | Toggle lines |
| `b` | Toggle badges |
| `Escape` | Close modals |
| `Ctrl+E` | Export config |
| `Ctrl+I` | Import config |

---

## 11. Display Modes

- **full**: Shows all task details, descriptions, and actions
- **compact**: Shows minimal task info, single item visible
- **minimal**: Dot indicator that expands on hover
